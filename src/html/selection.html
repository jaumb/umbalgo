<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/default.min.css">
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>


    <script type="text/javascript" src="https://d3js.org/d3.v3.min.js"></script>
    <script type="text/javascript" src="js/libs/vizlib/common.js"></script>
    <script type="text/javascript" src="js/libs/vizlib/factories/element_factory.js">
    </script>
    <script type="text/javascript" src="js/libs/vizlib/factories/array_factory.js"></script>
    <script type="text/javascript" src="js/libs/vizlib/algorithms/selection.js"></script>
    <script type="text/javascript" src="js/libs/vizlib/vizlib.js"></script>
    <script type="text/javascript" src="js/libs/vizlib/redraw.js"></script>


    <script type="text/javascript" src="js/libs/runner.js"></script>
  </head>
  <body>
    <button type="button" onclick="onInvoke()">invoke</button>
    <button type="button" onclick="onNext()">next</button>
    <div id="codeNote">
      <!-- Dynamically generated note will be inserted here -->
    </div>
    <pre>
      <code id="codePane">
        <!-- Dynamically generated code pane will be inserted here -->
      </code>
    </pre>
    <div class="chart-container" style="max-width: 1000px;"></div>
    <table border="1">
      <tr>
        <td><h3>Stack</h3></td>
        <td><h3>Locals</h3></td>
        <td><h3>Arguments</h3></td>
      <tr>
        <td>
          <div id="stackPane">
            <!-- Dynamically generated stack trace will be inserted here -->
          </div>
        </td>
        <td>
          <div id="localsPane">
            <!-- Dynamically generated stack trace will be inserted here -->
          </div>
        </td>
        <td>
          <div id="argsPane">
            <!-- Dynamically generated stack trace will be inserted here -->
          </div>
        </td>
      </tr>
    </table>
    <script type="text/javascript">
      let vm = new VirtualMachine();
      vm.loadFunc("exch.js");
      vm.loadFunc("less.js");
      vm.loadFunc("2.1-selection-sort.js");

      var svgW = window.innerWidth;
      var svgH = window.innerHeight;

      d3.select(".chart-container")
        .append("svg")
        .attr("width", svgW)
        .attr("height", svgH)
        .attr('id','svg_canvas');

      redraw.initCanvas();

      vm.dur = 1500;
      //var a = [0, 86, 71, 10, 75, 73, 64, 87, 23, 41];
      var a = [4, 8, 0, 1, 5, 7, 6, 2, 3];
      vm.viz = vizlib.get_selection(a, svgW, svgH);
      redraw.addOpsAndDraw(vm.viz, vm.dur, vm.viz.initializeMin());


/*


      var n = a.length;
      for (var i = 0; i < n; i++) {
        redraw.addOpsAndDraw(vm.viz, vm.dur,
                             vm.viz.emphasize([i]),
                             vm.viz.setMinPos(i));
        for (var j = i + 1; j < n; j++) {
          var min = i;
          redraw.addOpsAndDraw(vm.viz, vm.dur,
                               vm.viz.setMinLabel(a[i]),
                               vm.viz.setMinPos(j),
                               vm.viz.setFill([j], colors.COMPARE),
                               vm.viz.setMinFill(colors.ACTIVE));
          if (a[j] < a[min]) {
            min = j;
            redraw.addOpsAndDraw(vm.viz, vm.dur,
                                 vm.viz.setFill([min], colors.ACTIVE),
                                 vm.viz.setMinLabel(a[min]));
          }
          var tmp = a[i];
          a[i] = a[min];
          a[min] = tmp;
          redraw.addOpsAndDraw(vm.viz, vm.dur,
                               vm.viz.swap(i, min),
                               vm.viz.setFill([j], colors.BACKGROUND));
        }
        redraw.addOpsAndDraw(vm.viz, vm.dur,
                             vm.viz.setFill([i], colors.FINISHED),
                             vm.viz.deemphasize([i]));
      }
      redraw.addOpsAndDraw(vm.viz, vm.dur, vm.viz.setMinLabel(''));


*/


      const onInvoke = function() {
        //let a = [0, 86, 71, 10, 75, 73, 64, 87, 23, 41];
        console.log("Input: " + a);
        vm.invokeFunc("sort", function(result) { console.log("Result: " + a); }, a);
      };

      const onNext = function() {
        vm.next();
      };
    </script>
  </body>
</html>
