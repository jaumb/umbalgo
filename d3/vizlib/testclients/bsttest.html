<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>D3 Test</title>
    <script type="text/javascript" src="../d3.v3.js"></script>
    <script type="text/javascript" src="../common.js"></script>
    <script type="text/javascript" src="../factories/element_factory.js">
    </script>
    <script type="text/javascript" src="../factories/tree_factory.js"></script>
    <script type="text/javascript" src="../algorithms/bst.js"></script>
    <script type="text/javascript" src="../vizlib.js"></script>
    <script type="text/javascript" src="../redraw.js"></script>
  </head>
  <body>
    <div class="chart-container" style="max-width: 1000px;"></div>
    <script type="text/javascript">
      var svgW = window.innerWidth;
      var svgH = window.innerHeight;

      var svgCanvasName = 'svg_canvas';

      d3.select(".chart-container")
        .append("svg")
        .attr("width", svgW)
        .attr("height", svgH)
        .attr('id',svgCanvasName);

      redraw.initCanvas(svgCanvasName);

      // duration for visualization
      var dur = 15000;
      var root = null;
      var ids = 1;

      // get the BST visualization
      var viz = vizlib.getBST(1000, svgW, svgH);

      // get 5 randomly ordered integers
      elements = d3.range(1,6);
      d3.shuffle(elements);

      // visualize inserting elements one at a time
      elements.forEach(function(e) {
        var newElem = new node(ids++, e, null, null);
        root = addNode(root, newElem);
        redraw.addOpsAndDraw(viz, dur, viz.buildTree(root));

        function addNode(currNode, newNode) {
          if (!currNode) {
              return newNode;
          } else if (newNode.val() > currNode.val()) {
              currNode._rc = addNode(currNode._rc, newNode);
          } else if (newNode.val() < currNode.val()) {
              currNode._lc = addNode(currNode._lc, newNode);
          }
          return newNode;
        }
      });

      // tree node representation
      // id(), val(), lChild(), and rChild() are expected by tree visualizations
      function node(uid, nodeVal, lc, rc) {
        var _id = uid;
        var _val = nodeVal;
        var _lc = lc;
        var _rc = rc;

        var id = function() { return _id; }
        var val = function() { return _val; }
        var lChild = function() {return _lc; }
        var rChild = function() {return _rc; }
      }

    </script>
  </body>
</html>
